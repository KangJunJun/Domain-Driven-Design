# Chapter 6 - 응용 서비스와 표현 영역

## 6.1 표현 영역과 응용 영역

도메인 영역만 잘 구현하면 제대로 된 소프트웨어를 만들지 못한다.  
도메인이 제 기능을 하려면 사용자와 도메인을 연결해 주는 매개체(표현영역과 응용영역)가 필요하다.  

* 표현 영역  
사용자의 요청을 해석한다.  
요청받은 표현 영역은 URL, 요청 파라미터, 쿠키, 헤더 등을 이용해서 사용자가 실행하고 싶은 기능을 판별하고 응용 서비스를 실행한다.
* 응용 영역  
실제 사용자가 원하는 기능을 제공.  
응용 서비스의 메서드가 요구하는 파라미터와 표현 영역이 사용자로부터 전달받은 데이터는 형식이 일치하지 않기 때문에 변환작업을 한다.

응용 서비스를 실행한 뒤에 표현 영역은 실행 결과를 사용자에게 알맞는 형식으로 응답한다. (HTML, JSON 등)  
사용자와 상호작용은 표현 영역이 처리하기 때문에, 응용 서비스는 표현 영역에 의존하지 않는다.  
즉, 응용영역은 표현영역 보다 고수준 정책이므로 응용영역은 표현형역에 의존해서는 안된다.  

## 6.2 응용 서비스의 역할

응용 서비스는 사용자의 요청을 처리하기 위해 리포지터리에서 도메인 객체를 가져와 사용한다.  
응용 서비스는 주로 도메인 객체간 흐름을 제어한다.

````java
public class someService() {
    public Result doSomeFunc(SomeReq req) {
        // 리포자터리에서 애그리거트를 구한다.
        SomeAgg agg = someAggRepository.findById(req.getId());
        checkNull(agg);
        // 에그리거트의 도메인 기능을 실행한다.
        agg.doFunc(req.getValue());
        // 결과를 리턴한다.
        return createSuccessResult(agg);
    }

    public Result doSomeCreation(CreateSomeReq req) {
        // 데이터 중복 등 유효성 검사를 한다.
        validate(req);
        // 애그리거트를 생성한다.
        SomeAgg newAgg = createSome(req);
        //리포지터리에 애그리거트를 저장한다.
        someAggRepository.save(newAgg);
        // 결과를 리턴한다.
        return createSuccessResult(newAgg);
    }
}
````

응용서비스가 복잡하다면 도메인 로직의 일부를 구현하고 있을 가능성이 높다.

응용서비스는 트랜잭션 처리와 접근 제어, 이벤트 처리도 담당한다.

### 6.2.1 도메인 로직 넣지 않기

만약 도메인 로직이 응용영역에 위치한다면 다음과 같은 문제를 야기한다.

1. 코드의 응집성이 떨어진다.  
   응용영역에 위치한 코드로 인해 해당 도메인 관련 코드를 분석할 때 도메인영역내의 로직뿐만이 아니라 여기저기 흩어져있는 응용영역도 분석 해야한다.
2. 중복 코드 발생  
   도메인관련 코드는 도메인이 책임을 가지고 구현하고, 퍼블릭 메서드로 외부에 제공되어야한다.  
   그리고 응용 영역에서는 이 퍼블릭 메서드를 사용하기위해 단순히 메시지만 전송하면 된다.  
   만일 도메인 로직이 응용영역에 위치해 응용영역에서 구현한다면 같은 여러 응용 영역 내 중복되는 도메인로직이 존재할 가능성이 높다.
 
## 6.3 응용 서비스의 구현

### 6.3.1 응용 서비스의 크기

### 6.3.2 응용 서비스의 인터페이스와 클래스

### 6.3.3 메서드 파라미터와 값 리턴

### 6.3.4 표현 영역에 의존하지 않기

### 6.3.5 트랜잭션 처리

## 6.4 표현 영역

## 6.5 값 검증

## 6.6 권한 검사

## 6.7 조회 전용 기능과 응용 서비스